ä½¿ç”¨JdbcTemplateé˜²æ­¢SQLæ³¨å…¥çš„æ ¸å¿ƒæ˜¯**ä¸¥æ ¼ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢ï¼ˆPreparedStatementï¼‰**ï¼Œé¿å…ç›´æ¥æ‹¼æ¥ç”¨æˆ·è¾“å…¥ã€‚ä»¥ä¸‹æ˜¯å…·ä½“å®è·µå’Œæ³¨æ„äº‹é¡¹ï¼š

---

### **1. ä½¿ç”¨ `?` å ä½ç¬¦ + å‚æ•°ä¼ é€’**
**æ­£ç¡®åšæ³•**ï¼šç”¨ `?` å ä½ï¼Œé€šè¿‡`Object[]`æˆ–`PreparedStatementSetter`ä¼ é€’å‚æ•°ã€‚
```java
String sql = "SELECT * FROM users WHERE username = ? AND password = ?";
jdbcTemplate.query(sql, new Object[]{userInputName, userInputPwd}, rowMapper);
```

**é”™è¯¯åšæ³•**ï¼ˆå¯¼è‡´æ³¨å…¥é£é™©ï¼‰ï¼š
```java
// ç›´æ¥æ‹¼æ¥ç”¨æˆ·è¾“å…¥ï¼å±é™©ï¼
String sql = "SELECT * FROM users WHERE username = '" + userInput + "'";
jdbcTemplate.query(sql, rowMapper);
```

---

### **2. ä½¿ç”¨å‘½åå‚æ•°ï¼ˆ`NamedParameterJdbcTemplate`ï¼‰**
æ›´å®‰å…¨çš„æ›¿ä»£æ–¹æ¡ˆï¼Œæ”¯æŒå…·åå‚æ•°ï¼ˆå¦‚ `:paramName`ï¼‰ï¼š
```java
NamedParameterJdbcTemplate namedTemplate = new NamedParameterJdbcTemplate(dataSource);

String sql = "SELECT * FROM users WHERE username = :name";
Map<String, Object> params = new HashMap<>();
params.put("name", userInputName);

namedTemplate.query(sql, params, rowMapper);
```

---

### **3. é¿å…åŠ¨æ€è¡¨å/åˆ—åæ‹¼æ¥**
è‹¥å¿…é¡»åŠ¨æ€æŒ‡å®šè¡¨å/åˆ—åï¼ˆå¦‚ `ORDER BY`ï¼‰ï¼š
- **ç™½åå•æ ¡éªŒ**ï¼šåªå…è®¸é¢„å®šä¹‰çš„åˆæ³•å€¼ï¼ˆå¦‚ `id`, `name`ï¼‰ã€‚
```java
// ç¤ºä¾‹ï¼šæ ¡éªŒåˆ—åæ˜¯å¦åˆæ³•
List<String> validColumns = Arrays.asList("id", "name", "email");
String orderBy = validColumns.contains(inputColumn) ? inputColumn : "id";

String sql = "SELECT * FROM users ORDER BY " + orderBy;
jdbcTemplate.query(sql, rowMapper); // æ­¤æ—¶SQLæ˜¯å›ºå®šçš„
```

---

### **4. ç¦æ­¢`String.format()`/`+`æ‹¼æ¥SQL**
ä»¥ä¸‹æ“ä½œ**æåº¦å±é™©**ï¼ˆJdbcTemplateæ— æ³•æä¾›ä¿æŠ¤ï¼‰ï¼š
```java
// âŒ å…¨éƒ¨æœ‰æ³¨å…¥é£é™©ï¼
String sql1 = String.format("SELECT * FROM %s", userInputTable);
String sql2 = "DELETE FROM users WHERE id = " + userInputId;
jdbcTemplate.execute(sql1); // ç›¸å½“äºè£¸å¥”ï¼
```

---

### **5. ç‰¹æ®Šåœºæ™¯ï¼š`IN` è¯­å¥**
ä½¿ç”¨ `NamedParameterJdbcTemplate` å®‰å…¨å¤„ç† `IN` å­å¥ï¼š
```java
String sql = "SELECT * FROM users WHERE id IN (:ids)";
Map<String, Object> params = new HashMap<>();
params.put("ids", Arrays.asList(1, 2, 3)); // ç›´æ¥ä¼ List

namedTemplate.query(sql, params, rowMapper);
```

---

### **ä¸ºä»€ä¹ˆJdbcTemplateèƒ½é˜²æ³¨å…¥ï¼Ÿ**
- **é¢„ç¼–è¯‘æœºåˆ¶**ï¼šåº•å±‚ä½¿ç”¨`PreparedStatement`ï¼Œç”¨æˆ·è¾“å…¥ä¼šè¢«è§†ä¸ºæ•°æ®è€ŒéSQLä»£ç ã€‚
- **å‚æ•°è½¬ä¹‰**ï¼šæ•°æ®åº“é©±åŠ¨ä¼šè‡ªåŠ¨å¯¹ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚ `'`ã€`;`ï¼‰è½¬ä¹‰å¤„ç†ã€‚
- **ç±»å‹å®‰å…¨**ï¼šå‚æ•°ç±»å‹ä¸å ä½ç¬¦ç»‘å®šï¼Œé¿å…æ¶æ„æ„é€ ç±»å‹ç ´åç»“æ„ã€‚

---

### **æ€»ç»“ï¼šå®‰å…¨å‡†åˆ™**
| **åœºæ™¯**               | **å®‰å…¨åšæ³•**                                      | **é£é™©åšæ³•**               |
|------------------------|-------------------------------------------------|--------------------------|
| æ™®é€šæ¡ä»¶æŸ¥è¯¢           | ä½¿ç”¨ `?` å ä½ç¬¦ + `Object[]`/`PreparedStatementSetter` | å­—ç¬¦ä¸²æ‹¼æ¥SQL             |
| å‘½åå‚æ•°               | `NamedParameterJdbcTemplate` + `Map`             | æ‹¼æ¥å‘½åå‚æ•°              |
| åŠ¨æ€è¡¨å/åˆ—å          | ç™½åå•æ ¡éªŒ                                        | ç›´æ¥ä½¿ç”¨ç”¨æˆ·è¾“å…¥          |
| `IN` è¯­å¥              | ä¼  `List` ç±»å‹å‚æ•°                                | æ‰‹åŠ¨æ‹¼æ¥ `(v1,v2,...)`   |

> ğŸ“Œ **å…³é”®ç‚¹**ï¼š**æ‰€æœ‰ç”¨æˆ·è¾“å…¥å¿…é¡»é€šè¿‡å‚æ•°ä¼ é€’ï¼Œè€ŒéåµŒå…¥SQLå­—ç¬¦ä¸²**ã€‚JdbcTemplateæœ¬èº«æ˜¯å®‰å…¨çš„ï¼Œä½†é”™è¯¯ä½¿ç”¨ï¼ˆå¦‚æ‹¼æ¥SQLï¼‰ä¼šç»•è¿‡å…¶ä¿æŠ¤æœºåˆ¶ã€‚